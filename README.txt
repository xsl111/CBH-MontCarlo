这是Compact BH算法的代码，其中也包含了应用部分